<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>infutil.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>infutil.h</h1><div class="fragment"><pre>00001 <span class="comment">/* infutil.h -- types and macros common to blocks and codes</span>
00002 <span class="comment"> * Copyright (C) 1995-2002 Mark Adler</span>
00003 <span class="comment"> * For conditions of distribution and use, see copyright notice in zlib.h </span>
00004 <span class="comment"> */</span>
00005 
00006 <span class="comment">/* WARNING: this file should *not* be used by applications. It is</span>
00007 <span class="comment">   part of the implementation of the compression library and is</span>
00008 <span class="comment">   subject to change. Applications should only use zlib.h.</span>
00009 <span class="comment"> */</span>
00010 
00011 <span class="preprocessor">#ifndef _INFUTIL_H</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define _INFUTIL_H</span>
00013 <span class="preprocessor"></span>
00014 <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00015       TYPE,     <span class="comment">/* get type bits (3, including end bit) */</span>
00016       LENS,     <span class="comment">/* get lengths for stored */</span>
00017       STORED,   <span class="comment">/* processing stored block */</span>
00018       TABLE,    <span class="comment">/* get table lengths */</span>
00019       BTREE,    <span class="comment">/* get bit lengths tree for a dynamic block */</span>
00020       DTREE,    <span class="comment">/* get length, distance trees for a dynamic block */</span>
00021       CODES,    <span class="comment">/* processing fixed or dynamic block */</span>
00022       DRY,      <span class="comment">/* output remaining window bytes */</span>
00023       DONE,     <span class="comment">/* finished last block, done */</span>
00024       BAD}      <span class="comment">/* got a data error--stuck here */</span>
00025 inflate_block_mode;
00026 
00027 <span class="comment">/* inflate blocks semi-private state */</span>
00028 <span class="keyword">struct </span>inflate_blocks_state {
00029 
00030   <span class="comment">/* mode */</span>
00031   inflate_block_mode  mode;     <span class="comment">/* current inflate_block mode */</span>
00032 
00033   <span class="comment">/* mode dependent information */</span>
00034   <span class="keyword">union </span>{
00035     uInt left;          <span class="comment">/* if STORED, bytes left to copy */</span>
00036     <span class="keyword">struct </span>{
00037       uInt table;               <span class="comment">/* table lengths (14 bits) */</span>
00038       uInt index;               <span class="comment">/* index into blens (or border) */</span>
00039       uIntf *blens;             <span class="comment">/* bit lengths of codes */</span>
00040       uInt bb;                  <span class="comment">/* bit length tree depth */</span>
00041       inflate_huft *tb;         <span class="comment">/* bit length decoding tree */</span>
00042     } trees;            <span class="comment">/* if DTREE, decoding info for trees */</span>
00043     <span class="keyword">struct </span>{
00044       inflate_codes_statef 
00045          *codes;
00046     } decode;           <span class="comment">/* if CODES, current state */</span>
00047   } sub;                <span class="comment">/* submode */</span>
00048   uInt last;            <span class="comment">/* true if this block is the last block */</span>
00049 
00050   <span class="comment">/* mode independent information */</span>
00051   uInt bitk;            <span class="comment">/* bits in bit buffer */</span>
00052   uLong bitb;           <span class="comment">/* bit buffer */</span>
00053   inflate_huft *hufts;  <span class="comment">/* single malloc for tree space */</span>
00054   Bytef *window;        <span class="comment">/* sliding window */</span>
00055   Bytef *end;           <span class="comment">/* one byte after sliding window */</span>
00056   Bytef *read;          <span class="comment">/* window read pointer */</span>
00057   Bytef *write;         <span class="comment">/* window write pointer */</span>
00058   check_func checkfn;   <span class="comment">/* check function */</span>
00059   uLong check;          <span class="comment">/* check on output */</span>
00060 
00061 };
00062 
00063 
00064 <span class="comment">/* defines for inflate input/output */</span>
00065 <span class="comment">/*   update pointers and return */</span>
00066 <span class="preprocessor">#define UPDBITS {s-&gt;bitb=b;s-&gt;bitk=k;}</span>
00067 <span class="preprocessor"></span><span class="preprocessor">#define UPDIN {z-&gt;avail_in=n;z-&gt;total_in+=p-z-&gt;next_in;z-&gt;next_in=p;}</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define UPDOUT {s-&gt;write=q;}</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define UPDATE {UPDBITS UPDIN UPDOUT}</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define LEAVE {UPDATE return inflate_flush(s,z,r);}</span>
00071 <span class="preprocessor"></span><span class="comment">/*   get bytes and bits */</span>
00072 <span class="preprocessor">#define LOADIN {p=z-&gt;next_in;n=z-&gt;avail_in;b=s-&gt;bitb;k=s-&gt;bitk;}</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define NEEDBYTE {if(n)r=Z_OK;else LEAVE}</span>
00074 <span class="preprocessor"></span><span class="preprocessor">#define NEXTBYTE (n--,*p++)</span>
00075 <span class="preprocessor"></span><span class="preprocessor">#define NEEDBITS(j) {while(k&lt;(j)){NEEDBYTE;b|=((uLong)NEXTBYTE)&lt;&lt;k;k+=8;}}</span>
00076 <span class="preprocessor"></span><span class="preprocessor">#define DUMPBITS(j) {b&gt;&gt;=(j);k-=(j);}</span>
00077 <span class="preprocessor"></span><span class="comment">/*   output bytes */</span>
00078 <span class="preprocessor">#define WAVAIL (uInt)(q&lt;s-&gt;read?s-&gt;read-q-1:s-&gt;end-q)</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#define LOADOUT {q=s-&gt;write;m=(uInt)WAVAIL;}</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#define WRAP {if(q==s-&gt;end&amp;&amp;s-&gt;read!=s-&gt;window){q=s-&gt;window;m=(uInt)WAVAIL;}}</span>
00081 <span class="preprocessor"></span><span class="preprocessor">#define FLUSH {UPDOUT r=inflate_flush(s,z,r); LOADOUT}</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define NEEDOUT {if(m==0){WRAP if(m==0){FLUSH WRAP if(m==0) LEAVE}}r=Z_OK;}</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define OUTBYTE(a) {*q++=(Byte)(a);m--;}</span>
00084 <span class="preprocessor"></span><span class="comment">/*   load local pointers */</span>
00085 <span class="preprocessor">#define LOAD {LOADIN LOADOUT}</span>
00086 <span class="preprocessor"></span>
00087 <span class="comment">/* masks for lower bits (size given to avoid silly warnings with Visual C++) */</span>
00088 <span class="keyword">extern</span> uInt inflate_mask[17];
00089 
00090 <span class="comment">/* copy as much as possible from the sliding window to the output area */</span>
00091 <span class="keyword">extern</span> <span class="keywordtype">int</span> inflate_flush OF((
00092     inflate_blocks_statef *,
00093     z_streamp ,
00094     <span class="keywordtype">int</span>));
00095 
00096 <span class="keyword">struct </span>internal_state      {<span class="keywordtype">int</span> dummy;}; <span class="comment">/* for buggy compilers */</span>
00097 
00098 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:42 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
