<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>zutil.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>zutil.h</h1><div class="fragment"><pre>00001 <span class="comment">/* zutil.h -- internal interface and configuration of the compression library</span>
00002 <span class="comment"> * Copyright (C) 1995-2002 Jean-loup Gailly.</span>
00003 <span class="comment"> * For conditions of distribution and use, see copyright notice in zlib.h</span>
00004 <span class="comment"> */</span>
00005 
00006 <span class="comment">/* WARNING: this file should *not* be used by applications. It is</span>
00007 <span class="comment">   part of the implementation of the compression library and is</span>
00008 <span class="comment">   subject to change. Applications should only use zlib.h.</span>
00009 <span class="comment"> */</span>
00010 
00011 <span class="comment">/* @(#) $Id: zutil_8h-source.html,v 1.1 2002/11/14 01:50:05 garyjharris Exp $ */</span>
00012 
00013 <span class="preprocessor">#ifndef _Z_UTIL_H</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#define _Z_UTIL_H</span>
00015 <span class="preprocessor"></span>
00016 <span class="preprocessor">#include "zlib.h"</span>
00017 
00018 <span class="preprocessor">#ifdef STDC</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;stddef.h&gt;</span>
00020 <span class="preprocessor">#  include &lt;string.h&gt;</span>
00021 <span class="preprocessor">#  include &lt;stdlib.h&gt;</span>
00022 <span class="preprocessor">#endif</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#ifdef NO_ERRNO_H</span>
00024 <span class="preprocessor"></span>    <span class="keyword">extern</span> <span class="keywordtype">int</span> errno;
00025 <span class="preprocessor">#else</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#   include &lt;errno.h&gt;</span>
00027 <span class="preprocessor">#endif</span>
00028 <span class="preprocessor"></span>
00029 <span class="preprocessor">#ifndef local</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#  define local static</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00032 <span class="preprocessor"></span><span class="comment">/* compile with -Dlocal if your debugger can't find static symbols */</span>
00033 
00034 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>  uch;
00035 <span class="keyword">typedef</span> uch FAR uchf;
00036 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ush;
00037 <span class="keyword">typedef</span> ush FAR ushf;
00038 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  ulg;
00039 
00040 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *z_errmsg[10]; <span class="comment">/* indexed by 2-zlib_error */</span>
00041 <span class="comment">/* (size given to avoid silly warnings with Visual C++) */</span>
00042 
00043 <span class="preprocessor">#define ERR_MSG(err) z_errmsg[Z_NEED_DICT-(err)]</span>
00044 <span class="preprocessor"></span>
00045 <span class="preprocessor">#define ERR_RETURN(strm,err) \</span>
00046 <span class="preprocessor">  return (strm-&gt;msg = (char*)ERR_MSG(err), (err))</span>
00047 <span class="preprocessor"></span><span class="comment">/* To be used only when the state is known to be valid */</span>
00048 
00049         <span class="comment">/* common constants */</span>
00050 
00051 <span class="preprocessor">#ifndef DEF_WBITS</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#  define DEF_WBITS MAX_WBITS</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00054 <span class="preprocessor"></span><span class="comment">/* default windowBits for decompression. MAX_WBITS is for compression only */</span>
00055 
00056 <span class="preprocessor">#if MAX_MEM_LEVEL &gt;= 8</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#  define DEF_MEM_LEVEL 8</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#  define DEF_MEM_LEVEL  MAX_MEM_LEVEL</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00061 <span class="preprocessor"></span><span class="comment">/* default memLevel */</span>
00062 
00063 <span class="preprocessor">#define STORED_BLOCK 0</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define STATIC_TREES 1</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define DYN_TREES    2</span>
00066 <span class="preprocessor"></span><span class="comment">/* The three kinds of block type */</span>
00067 
00068 <span class="preprocessor">#define MIN_MATCH  3</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define MAX_MATCH  258</span>
00070 <span class="preprocessor"></span><span class="comment">/* The minimum and maximum match lengths */</span>
00071 
00072 <span class="preprocessor">#define PRESET_DICT 0x20 </span><span class="comment">/* preset dictionary flag in zlib header */</span>
00073 
00074         <span class="comment">/* target dependencies */</span>
00075 
00076 <span class="preprocessor">#ifdef MSDOS</span>
00077 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x00</span>
00078 <span class="preprocessor"></span><span class="preprocessor">#  if defined(__TURBOC__) || defined(__BORLANDC__)</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#    if(__STDC__ == 1) &amp;&amp; (defined(__LARGE__) || defined(__COMPACT__))</span>
00080 <span class="preprocessor"></span>       <span class="comment">/* Allow compilation with ANSI keywords only enabled */</span>
00081        <span class="keywordtype">void</span> _Cdecl farfree( <span class="keywordtype">void</span> *block );
00082        <span class="keywordtype">void</span> *_Cdecl farmalloc( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nbytes );
00083 <span class="preprocessor">#    else</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#     include &lt;alloc.h&gt;</span>
00085 <span class="preprocessor">#    endif</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#  else </span><span class="comment">/* MSC or DJGPP */</span>
00087 <span class="preprocessor">#    include &lt;malloc.h&gt;</span>
00088 <span class="preprocessor">#  endif</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00090 <span class="preprocessor"></span>
00091 <span class="preprocessor">#ifdef OS2</span>
00092 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x06</span>
00093 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00094 <span class="preprocessor"></span>
00095 <span class="preprocessor">#ifdef WIN32 </span><span class="comment">/* Window 95 &amp; Windows NT */</span>
00096 <span class="preprocessor">#  define OS_CODE  0x0b</span>
00097 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00098 <span class="preprocessor"></span>
00099 <span class="preprocessor">#if defined(VAXC) || defined(VMS)</span>
00100 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x02</span>
00101 <span class="preprocessor"></span><span class="preprocessor">#  define F_OPEN(name, mode) \</span>
00102 <span class="preprocessor">     fopen((name), (mode), "mbc=60", "ctx=stm", "rfm=fix", "mrs=512")</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00104 <span class="preprocessor"></span>
00105 <span class="preprocessor">#ifdef AMIGA</span>
00106 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x01</span>
00107 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00108 <span class="preprocessor"></span>
00109 <span class="preprocessor">#if defined(ATARI) || defined(atarist)</span>
00110 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x05</span>
00111 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00112 <span class="preprocessor"></span>
00113 <span class="preprocessor">#if defined(MACOS) || defined(TARGET_OS_MAC)</span>
00114 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x07</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#  if defined(__MWERKS__) &amp;&amp; __dest_os != __be_os &amp;&amp; __dest_os != __win32_os</span>
00116 <span class="preprocessor"></span><span class="preprocessor">#    include &lt;unix.h&gt;</span> <span class="comment">/* for fdopen */</span>
00117 <span class="preprocessor">#  else</span>
00118 <span class="preprocessor"></span><span class="preprocessor">#    ifndef fdopen</span>
00119 <span class="preprocessor"></span><span class="preprocessor">#      define fdopen(fd,mode) NULL </span><span class="comment">/* No fdopen() */</span>
00120 <span class="preprocessor">#    endif</span>
00121 <span class="preprocessor"></span><span class="preprocessor">#  endif</span>
00122 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00123 <span class="preprocessor"></span>
00124 <span class="preprocessor">#ifdef __50SERIES </span><span class="comment">/* Prime/PRIMOS */</span>
00125 <span class="preprocessor">#  define OS_CODE  0x0F</span>
00126 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00127 <span class="preprocessor"></span>
00128 <span class="preprocessor">#ifdef TOPS20</span>
00129 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x0a</span>
00130 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00131 <span class="preprocessor"></span>
00132 <span class="preprocessor">#if defined(_BEOS_) || defined(RISCOS)</span>
00133 <span class="preprocessor"></span><span class="preprocessor">#  define fdopen(fd,mode) NULL </span><span class="comment">/* No fdopen() */</span>
00134 <span class="preprocessor">#endif</span>
00135 <span class="preprocessor"></span>
00136 <span class="preprocessor">#if (defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt; 600))</span>
00137 <span class="preprocessor"></span><span class="preprocessor">#  define fdopen(fd,type)  _fdopen(fd,type)</span>
00138 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00139 <span class="preprocessor"></span>
00140 
00141         <span class="comment">/* Common defaults */</span>
00142 
00143 <span class="preprocessor">#ifndef OS_CODE</span>
00144 <span class="preprocessor"></span><span class="preprocessor">#  define OS_CODE  0x03  </span><span class="comment">/* assume Unix */</span>
00145 <span class="preprocessor">#endif</span>
00146 <span class="preprocessor"></span>
00147 <span class="preprocessor">#ifndef F_OPEN</span>
00148 <span class="preprocessor"></span><span class="preprocessor">#  define F_OPEN(name, mode) fopen((name), (mode))</span>
00149 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00150 <span class="preprocessor"></span>
00151          <span class="comment">/* functions */</span>
00152 
00153 <span class="preprocessor">#ifdef HAVE_STRERROR</span>
00154 <span class="preprocessor"></span>   <span class="keyword">extern</span> <span class="keywordtype">char</span> *strerror OF((<span class="keywordtype">int</span>));
00155 <span class="preprocessor">#  define zstrerror(errnum) strerror(errnum)</span>
00156 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00157 <span class="preprocessor"></span><span class="preprocessor">#  define zstrerror(errnum) ""</span>
00158 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00159 <span class="preprocessor"></span>
00160 <span class="preprocessor">#if defined(pyr)</span>
00161 <span class="preprocessor"></span><span class="preprocessor">#  define NO_MEMCPY</span>
00162 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00163 <span class="preprocessor"></span><span class="preprocessor">#if defined(SMALL_MEDIUM) &amp;&amp; !defined(_MSC_VER) &amp;&amp; !defined(__SC__)</span>
00164 <span class="preprocessor"></span> <span class="comment">/* Use our own functions for small and medium model with MSC &lt;= 5.0.</span>
00165 <span class="comment">  * You may have to use the same strategy for Borland C (untested).</span>
00166 <span class="comment">  * The __SC__ check is for Symantec.</span>
00167 <span class="comment">  */</span>
00168 <span class="preprocessor">#  define NO_MEMCPY</span>
00169 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00170 <span class="preprocessor"></span><span class="preprocessor">#if defined(STDC) &amp;&amp; !defined(HAVE_MEMCPY) &amp;&amp; !defined(NO_MEMCPY)</span>
00171 <span class="preprocessor"></span><span class="preprocessor">#  define HAVE_MEMCPY</span>
00172 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00173 <span class="preprocessor"></span><span class="preprocessor">#ifdef HAVE_MEMCPY</span>
00174 <span class="preprocessor"></span><span class="preprocessor">#  ifdef SMALL_MEDIUM </span><span class="comment">/* MSDOS small or medium model */</span>
00175 <span class="preprocessor">#    define zmemcpy _fmemcpy</span>
00176 <span class="preprocessor"></span><span class="preprocessor">#    define zmemcmp _fmemcmp</span>
00177 <span class="preprocessor"></span><span class="preprocessor">#    define zmemzero(dest, len) _fmemset(dest, 0, len)</span>
00178 <span class="preprocessor"></span><span class="preprocessor">#  else</span>
00179 <span class="preprocessor"></span><span class="preprocessor">#    define zmemcpy memcpy</span>
00180 <span class="preprocessor"></span><span class="preprocessor">#    define zmemcmp memcmp</span>
00181 <span class="preprocessor"></span><span class="preprocessor">#    define zmemzero(dest, len) memset(dest, 0, len)</span>
00182 <span class="preprocessor"></span><span class="preprocessor">#  endif</span>
00183 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00184 <span class="preprocessor"></span>   <span class="keyword">extern</span> <span class="keywordtype">void</span> zmemcpy  OF((Bytef* dest, <span class="keyword">const</span> Bytef* source, uInt len));
00185    <span class="keyword">extern</span> <span class="keywordtype">int</span>  zmemcmp  OF((<span class="keyword">const</span> Bytef* s1, <span class="keyword">const</span> Bytef* s2, uInt len));
00186    <span class="keyword">extern</span> <span class="keywordtype">void</span> zmemzero OF((Bytef* dest, uInt len));
00187 <span class="preprocessor">#endif</span>
00188 <span class="preprocessor"></span>
00189 <span class="comment">/* Diagnostic functions */</span>
00190 <span class="preprocessor">#ifdef DEBUG</span>
00191 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;stdio.h&gt;</span>
00192    <span class="keyword">extern</span> <span class="keywordtype">int</span> z_verbose;
00193    <span class="keyword">extern</span> <span class="keywordtype">void</span> z_error    OF((<span class="keywordtype">char</span> *m));
00194 <span class="preprocessor">#  define Assert(cond,msg) {if(!(cond)) z_error(msg);}</span>
00195 <span class="preprocessor"></span><span class="preprocessor">#  define Trace(x) {if (z_verbose&gt;=0) fprintf x ;}</span>
00196 <span class="preprocessor"></span><span class="preprocessor">#  define Tracev(x) {if (z_verbose&gt;0) fprintf x ;}</span>
00197 <span class="preprocessor"></span><span class="preprocessor">#  define Tracevv(x) {if (z_verbose&gt;1) fprintf x ;}</span>
00198 <span class="preprocessor"></span><span class="preprocessor">#  define Tracec(c,x) {if (z_verbose&gt;0 &amp;&amp; (c)) fprintf x ;}</span>
00199 <span class="preprocessor"></span><span class="preprocessor">#  define Tracecv(c,x) {if (z_verbose&gt;1 &amp;&amp; (c)) fprintf x ;}</span>
00200 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00201 <span class="preprocessor"></span><span class="preprocessor">#  define Assert(cond,msg)</span>
00202 <span class="preprocessor"></span><span class="preprocessor">#  define Trace(x)</span>
00203 <span class="preprocessor"></span><span class="preprocessor">#  define Tracev(x)</span>
00204 <span class="preprocessor"></span><span class="preprocessor">#  define Tracevv(x)</span>
00205 <span class="preprocessor"></span><span class="preprocessor">#  define Tracec(c,x)</span>
00206 <span class="preprocessor"></span><span class="preprocessor">#  define Tracecv(c,x)</span>
00207 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00208 <span class="preprocessor"></span>
00209 
00210 <span class="keyword">typedef</span> uLong (ZEXPORT *check_func) OF((uLong check, <span class="keyword">const</span> Bytef *buf,
00211                        uInt len));
00212 voidpf zcalloc OF((voidpf opaque, <span class="keywordtype">unsigned</span> items, <span class="keywordtype">unsigned</span> size));
00213 <span class="keywordtype">void</span>   zcfree  OF((voidpf opaque, voidpf ptr));
00214 
00215 <span class="preprocessor">#define ZALLOC(strm, items, size) \</span>
00216 <span class="preprocessor">           (*((strm)-&gt;zalloc))((strm)-&gt;opaque, (items), (size))</span>
00217 <span class="preprocessor"></span><span class="preprocessor">#define ZFREE(strm, addr)  (*((strm)-&gt;zfree))((strm)-&gt;opaque, (voidpf)(addr))</span>
00218 <span class="preprocessor"></span><span class="preprocessor">#define TRY_FREE(s, p) {if (p) ZFREE(s, p);}</span>
00219 <span class="preprocessor"></span>
00220 <span class="preprocessor">#endif </span><span class="comment">/* _Z_UTIL_H */</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:43 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
