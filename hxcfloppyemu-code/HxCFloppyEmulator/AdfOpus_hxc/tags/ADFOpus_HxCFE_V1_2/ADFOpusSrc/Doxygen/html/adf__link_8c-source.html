<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>adf_link.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>adf_link.c</h1><a href="adf__link_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> *  ADF Library. (C) 1997-2002 Laurent Clevy</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> */</span>
00011 <span class="preprocessor">#include&lt;string.h&gt;</span>
00012 
00013 <span class="preprocessor">#include"adf_defs.h"</span>
00014 <span class="preprocessor">#include"adf_str.h"</span>
00015 <span class="preprocessor">#include"adf_link.h"</span>
00016 <span class="preprocessor">#include"adf_dir.h"</span>
00017 
00018 <span class="keyword">extern</span> <span class="keyword">struct </span>Env adfEnv;
00019 
00020 <span class="comment">/*</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> *</span>
00023 <span class="comment"> */</span>
00024 <span class="keywordtype">char</span>* path(<span class="keyword">struct</span> Volume *vol, SECTNUM parent)
00025 {
00026     <span class="keyword">struct </span>bEntryBlock entryBlk;
00027     <span class="keywordtype">char</span> *tmpPath;
00028     <span class="keywordtype">int</span> len;
00029 
00030     tmpPath = NULL;
00031     adfReadEntryBlock(vol, parent, &amp;entryBlk);
00032     len = min(entryBlk.nameLen, MAXNAMELEN);
00033     memcpy(tmpPath,entryBlk.name,len);
00034     tmpPath[len]=<span class="charliteral">'\0'</span>;
00035 <span class="comment">/*    if (entryBlk.parent!=vol-&gt;rootBlock) {</span>
00036 <span class="comment">        return(strcat(path(vol,entryBlk.parent), tmpPath));</span>
00037 <span class="comment">    }</span>
00038 <span class="comment">    else</span>
00039 <span class="comment">   */</span>     <span class="keywordflow">return</span>(tmpPath);
00040 }
00041 
00042 
00043 <span class="comment">/*</span>
00044 <span class="comment"> *</span>
00045 <span class="comment"> *</span>
00046 <span class="comment"> */</span>
00047 RETCODE adfBlockPtr2EntryName(<span class="keyword">struct</span> Volume *vol, SECTNUM nSect, SECTNUM lPar, 
00048     <span class="keywordtype">char</span> **name, <span class="keywordtype">long</span> *size)
00049 {
00050     <span class="keyword">struct </span>bEntryBlock entryBlk;
00051     <span class="keyword">struct </span>Entry entry;
00052 
00053     <span class="keywordflow">if</span> (*name==0) {
00054         adfReadEntryBlock(vol, nSect, &amp;entryBlk);
00055         *size = entryBlk.byteSize;
00056 <span class="keywordflow">return</span> RC_OK;
00057         adfEntBlock2Entry(&amp;entryBlk, &amp;entry);   <span class="comment">/*error*/</span>
00058 <span class="comment">/*        if (entryBlk.secType!=ST_ROOT &amp;&amp; entry.parent!=lPar)</span>
00059 <span class="comment">            printf("path=%s\n",path(vol,entry.parent));</span>
00060 <span class="comment">*/</span>
00061        *name = strdup(<span class="stringliteral">""</span>);
00062         <span class="keywordflow">if</span> (*name==NULL)
00063             <span class="keywordflow">return</span> RC_MALLOC;
00064         <span class="keywordflow">return</span> RC_OK;
00065     }
00066     <span class="keywordflow">else</span>
00067 
00068     <span class="keywordflow">return</span> RC_OK;
00069 }
00070 
00071 <span class="comment">/*##################################################################################*/</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:38 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
