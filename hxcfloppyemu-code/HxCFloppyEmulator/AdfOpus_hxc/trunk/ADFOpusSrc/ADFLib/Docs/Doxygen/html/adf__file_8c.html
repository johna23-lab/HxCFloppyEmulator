<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>adf_file.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>adf_file.c File Reference</h1><a class="el" href="struct_file.html">File</a> code. 
<a href="#_details">More...</a>
<p>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include "<a class="el" href="adf__util_8h.html">adf_util.h</a>"</code><br>
<code>#include "<a class="el" href="adf__file_8h.html">adf_file.h</a>"</code><br>
<code>#include "<a class="el" href="adf__str_8h.html">adf_str.h</a>"</code><br>
<code>#include "<a class="el" href="defendian_8h.html">defendian.h</a>"</code><br>
<code>#include "<a class="el" href="adf__raw_8h.html">adf_raw.h</a>"</code><br>
<code>#include "<a class="el" href="adf__disk_8h.html">adf_disk.h</a>"</code><br>
<code>#include "<a class="el" href="adf__dir_8h.html">adf_dir.h</a>"</code><br>
<code>#include "<a class="el" href="adf__bitm_8h.html">adf_bitm.h</a>"</code><br>
<code>#include "<a class="el" href="adf__cache_8h.html">adf_cache.h</a>"</code><br>

<p>
Include dependency graph for adf_file.c:<p><center><img src="adf__file_8c__incl.png" border="0" usemap="#adf_file.c_map" alt="Include dependency graph"></center>
<map name="adf_file.c_map">
<area href="adf__util_8h.html" shape="rect" coords="153,140,230,158" alt="">
<area href="adf__str_8h.html" shape="rect" coords="25,246,97,265" alt="">
<area href="adf__file_8h.html" shape="rect" coords="153,182,230,201" alt="">
<area href="adf__raw_8h.html" shape="rect" coords="150,225,233,244" alt="">
<area href="adf__disk_8h.html" shape="rect" coords="150,268,233,286" alt="">
<area href="adf__dir_8h.html" shape="rect" coords="154,310,229,329" alt="">
<area href="adf__bitm_8h.html" shape="rect" coords="149,353,234,372" alt="">
<area href="adf__cache_8h.html" shape="rect" coords="146,396,237,414" alt="">
<area href="defendian_8h.html" shape="rect" coords="146,438,237,457" alt="">
</map>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a2">adfFlushFile</a> (struct <a class="el" href="struct_file.html">File</a> *file)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Flush a file.</em> <a href="#a2"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a5">adfFileRealSize</a> (unsigned long size, int blockSize, long *dataN, long *extN)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Compute and return real number of blocks used by one file, number of datablocks and file extension blocks.</em> <a href="#a5"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a7">adfFileSeek</a> (struct <a class="el" href="struct_file.html">File</a> *file, unsigned long pos)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Seek within a file.</em> <a href="#a7"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="struct_file.html">File</a> *&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a8">adfOpenFile</a> (struct <a class="el" href="struct_volume.html">Volume</a> *vol, char *name, char *mode)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Open a file in an ADF.</em> <a href="#a8"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a9">adfCloseFile</a> (struct <a class="el" href="struct_file.html">File</a> *file)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Close a file.</em> <a href="#a9"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a10">adfReadFile</a> (struct <a class="el" href="struct_file.html">File</a> *file, long n, unsigned char *buffer)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Read n bytes from the given file into a buffer.</em> <a href="#a10"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>BOOL&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a11">adfEndOfFile</a> (struct <a class="el" href="struct_file.html">File</a> *file)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Check if the end of a file has been reached.</em> <a href="#a11"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="adf__file_8c.html#a13">adfWriteFile</a> (struct <a class="el" href="struct_file.html">File</a> *file, long n, unsigned char *buffer)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Writes n bytes from the given buffer into a file.</em> <a href="#a13"></a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="struct_file.html">File</a> code.
<p>

<p>
<hr><h2>Function Documentation</h2>
<a name="a9" doxytag="adf_file.c::adfCloseFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void adfCloseFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>file</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Close a file.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- a pointer to a file structure containing the file to close. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
Void.</dl>Calls <a class="el" href="adf__file_8c.html#a2">adfFlushFile()</a> and frees the file structure.     </td>
  </tr>
</table>
<a name="a11" doxytag="adf_file.c::adfEndOfFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL adfEndOfFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>file</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check if the end of a file has been reached.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- the file to check. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
TRUE if the end of the file file has been reached. FALSE otherwise. </dl>    </td>
  </tr>
</table>
<a name="a5" doxytag="adf_file.c::adfFileRealSize"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long adfFileRealSize </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>size</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>blockSize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>dataN</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>extN</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute and return real number of blocks used by one file, number of datablocks and file extension blocks.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>size</em>&nbsp;</td><td>
- the file's size. </td></tr>
<tr><td valign=top><em>blockSize</em>&nbsp;</td><td>
- The volume's data block size. </td></tr>
<tr><td valign=top><em>dataN</em>&nbsp;</td><td>
- If not NULL, a pointer to a long to receive the number of data blocks used. </td></tr>
<tr><td valign=top><em>extN</em>&nbsp;</td><td>
- If not NULL, a pointer to a long to receive the number of file extension used. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
Returns the real size in blocks of a file with the given size.</dl>The blockSize must be 488 or 512. This information is located in the datablockSize of the <a class="el" href="struct_volume.html">Volume</a> structure. If the pointers dataN and extN aren't NULL, the number of data blocks and file extension blocks are returned. The return value does not take into account the new dircache that -may- be allocated.     </td>
  </tr>
</table>
<a name="a7" doxytag="adf_file.c::adfFileSeek"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void adfFileSeek </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>file</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pos</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Seek within a file.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- the file to seek within. </td></tr>
<tr><td valign=top><em>pos</em>&nbsp;</td><td>
- the position to seek to. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
Void. </dl>    </td>
  </tr>
</table>
<a name="a2" doxytag="adf_file.c::adfFlushFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void adfFlushFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>file</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flush a file.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- the file to flush. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
Void.</dl>Flushes a file's datablocks from memory to disk.     </td>
  </tr>
</table>
<a name="a8" doxytag="adf_file.c::adfOpenFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="struct_file.html">File</a>* adfOpenFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_volume.html">Volume</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>vol</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>mode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Open a file in an ADF.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>vol</em>&nbsp;</td><td>
- a pointer to the current volume structure. </td></tr>
<tr><td valign=top><em>name</em>&nbsp;</td><td>
- the file's name. </td></tr>
<tr><td valign=top><em>mode</em>&nbsp;</td><td>
- access mode. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
The <a class="el" href="struct_file.html">File</a> structure, ready to be read or written to. NULL if an error occurs : file not found with "r", or file already exists with "w".</dl>Opens the file with the name "name" which is located in the current working directory of "vol". The allowable modes are "r" and "w". If the mode is "w", the file mustn't already exist, otherwise an error occurs. Some basic access permissions are just checked for now.
<p>
Available access modes are "r" = read, "w" = write, "a" = append.     </td>
  </tr>
</table>
<a name="a10" doxytag="adf_file.c::adfReadFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long adfReadFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>file</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>n</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>buffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read n bytes from the given file into a buffer.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- the file to read from. </td></tr>
<tr><td valign=top><em>n</em>&nbsp;</td><td>
- the number of bytes to read. </td></tr>
<tr><td valign=top><em>buffer</em>&nbsp;</td><td>
- a buffer to receive the read bytes. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
The number of bytes really read.</dl>Use <a class="el" href="adf__file_8c.html#a11">adfEndOfFile()</a> to check if the end of the file is reached or not. See <a target="top" href="../../api_file.html">api_file.html</a> for example code.     </td>
  </tr>
</table>
<a name="a13" doxytag="adf_file.c::adfWriteFile"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long adfWriteFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="struct_file.html">File</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>file</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>n</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>buffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Writes n bytes from the given buffer into a file.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>file</em>&nbsp;</td><td>
- the file to write to. </td></tr>
<tr><td valign=top><em>n</em>&nbsp;</td><td>
- the number of bytes to write. </td></tr>
<tr><td valign=top><em>buffer</em>&nbsp;</td><td>
- a buffe containing the data to write. </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
The number of bytes written.</dl>See <a target="top" href="../../api_file.html">api_file.html</a> for example code.     </td>
  </tr>
</table>
<hr><address style="align: right;"><small>Generated on Sun Nov 17 22:45:16 2002 for staticlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
