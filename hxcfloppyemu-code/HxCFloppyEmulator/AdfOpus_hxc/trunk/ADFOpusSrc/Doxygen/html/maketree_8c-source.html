<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>maketree.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>maketree.c</h1><div class="fragment"><pre>00001 <span class="comment">/* maketree.c -- make inffixed.h table for decoding fixed codes</span>
00002 <span class="comment"> * Copyright (C) 1995-2002 Mark Adler</span>
00003 <span class="comment"> * For conditions of distribution and use, see copyright notice in zlib.h </span>
00004 <span class="comment"> */</span>
00005 
00006 <span class="comment">/* WARNING: this file should *not* be used by applications. It is</span>
00007 <span class="comment">   part of the implementation of the compression library and is</span>
00008 <span class="comment">   subject to change. Applications should only use zlib.h.</span>
00009 <span class="comment"> */</span>
00010 
00011 <span class="comment">/* This program is included in the distribution for completeness.</span>
00012 <span class="comment">   You do not need to compile or run this program since inffixed.h</span>
00013 <span class="comment">   is already included in the distribution.  To use this program</span>
00014 <span class="comment">   you need to compile zlib with BUILDFIXED defined and then compile</span>
00015 <span class="comment">   and link this program with the zlib library.  Then the output of</span>
00016 <span class="comment">   this program can be piped to inffixed.h. */</span>
00017 
00018 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00019 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00020 <span class="preprocessor">#include "zutil.h"</span>
00021 <span class="preprocessor">#include "inftrees.h"</span>
00022 
00023 <span class="comment">/* simplify the use of the inflate_huft type with some defines */</span>
00024 <span class="preprocessor">#define exop word.what.Exop</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#define bits word.what.Bits</span>
00026 <span class="preprocessor"></span>
00027 <span class="comment">/* generate initialization table for an inflate_huft structure array */</span>
00028 <span class="keywordtype">void</span> maketree(uInt b, inflate_huft *t)
00029 {
00030   <span class="keywordtype">int</span> i, e;
00031 
00032   i = 0;
00033   <span class="keywordflow">while</span> (1)
00034   {
00035     e = t[i].exop;
00036     <span class="keywordflow">if</span> (e &amp;&amp; (e &amp; (16+64)) == 0)        <span class="comment">/* table pointer */</span>
00037     {
00038       fprintf(stderr, <span class="stringliteral">"maketree: cannot initialize sub-tables!\n"</span>);
00039       exit(1);
00040     }
00041     <span class="keywordflow">if</span> (i % 4 == 0)
00042       printf(<span class="stringliteral">"\n   "</span>);
00043     printf(<span class="stringliteral">" {{{%u,%u}},%u}"</span>, t[i].exop, t[i].bits, t[i].base);
00044     <span class="keywordflow">if</span> (++i == (1&lt;&lt;b))
00045       <span class="keywordflow">break</span>;
00046     putchar(<span class="charliteral">','</span>);
00047   }
00048   puts(<span class="stringliteral">""</span>);
00049 }
00050 
00051 <span class="comment">/* create the fixed tables in C initialization syntax */</span>
00052 <span class="keywordtype">void</span> main(<span class="keywordtype">void</span>)
00053 {
00054   <span class="keywordtype">int</span> r;
00055   uInt bl, bd;
00056   inflate_huft *tl, *td;
00057   z_stream z;
00058 
00059   z.zalloc = zcalloc;
00060   z.opaque = (voidpf)0;
00061   z.zfree = zcfree;
00062   r = inflate_trees_fixed(&amp;bl, &amp;bd, &amp;tl, &amp;td, &amp;z);
00063   <span class="keywordflow">if</span> (r)
00064   {
00065     fprintf(stderr, <span class="stringliteral">"inflate_trees_fixed error %d\n"</span>, r);
00066     <span class="keywordflow">return</span>;
00067   }
00068   puts(<span class="stringliteral">"/* inffixed.h -- table for decoding fixed codes"</span>);
00069   puts(<span class="stringliteral">" * Generated automatically by the maketree.c program"</span>);
00070   puts(<span class="stringliteral">" */"</span>);
00071   puts(<span class="stringliteral">""</span>);
00072   puts(<span class="stringliteral">"/* WARNING: this file should *not* be used by applications. It is"</span>);
00073   puts(<span class="stringliteral">"   part of the implementation of the compression library and is"</span>);
00074   puts(<span class="stringliteral">"   subject to change. Applications should only use zlib.h."</span>);
00075   puts(<span class="stringliteral">" */"</span>);
00076   puts(<span class="stringliteral">""</span>);
00077   printf(<span class="stringliteral">"local uInt fixed_bl = %d;\n"</span>, bl);
00078   printf(<span class="stringliteral">"local uInt fixed_bd = %d;\n"</span>, bd);
00079   printf(<span class="stringliteral">"local inflate_huft fixed_tl[] = {"</span>);
00080   maketree(bl, tl);
00081   puts(<span class="stringliteral">"  };"</span>);
00082   printf(<span class="stringliteral">"local inflate_huft fixed_td[] = {"</span>);
00083   maketree(bd, td);
00084   puts(<span class="stringliteral">"  };"</span>);
00085 }
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:42 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
