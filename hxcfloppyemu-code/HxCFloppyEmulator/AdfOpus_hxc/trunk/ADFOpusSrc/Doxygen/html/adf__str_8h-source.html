<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>adf_str.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>adf_str.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef _ADF_STR_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _ADF_STR_H 1</span>
00003 <span class="preprocessor"></span>
00004 <span class="comment">/*</span>
00005 <span class="comment"> *  ADF Library. (C) 1997-2002 Laurent Clevy</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> *  adf_str.h</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> *  structures/constants definitions</span>
00010 <span class="comment"> */</span>
00011 
00012 <span class="preprocessor">#include&lt;stdio.h&gt;</span>
00013 
00014 <span class="preprocessor">#include"adf_defs.h"</span>
00015 <span class="preprocessor">#include"adf_blk.h"</span>
00016 <span class="preprocessor">#include"adf_err.h"</span>
00017 
00018 <span class="comment">/* ----- VOLUME ----- */</span>
00019 
00020 <span class="keyword">struct </span>Volume {
00021     <span class="keyword">struct </span>Device* dev;
00022 
00023     SECTNUM firstBlock;     <span class="comment">/* first block of data area (from beginning of device) */</span>
00024     SECTNUM lastBlock;      <span class="comment">/* last block of data area  (from beginning of device) */</span>
00025     SECTNUM rootBlock;      <span class="comment">/* root block (from firstBlock) */</span>
00026 
00027     <span class="keywordtype">char</span> dosType;           <span class="comment">/* FFS/OFS, DIRCACHE, INTERNATIONAL */</span>
00028     BOOL bootCode;
00029     BOOL readOnly;
00030     <span class="keywordtype">int</span> datablockSize;      <span class="comment">/* 488 or 512 */</span>
00031     <span class="keywordtype">int</span> blockSize;          <span class="comment">/* 512 */</span>
00032 
00033     <span class="keywordtype">char</span> *volName;
00034 
00035     BOOL mounted;
00036 
00037     <span class="keywordtype">long</span> bitmapSize;             <span class="comment">/* in blocks */</span>
00038     SECTNUM *bitmapBlocks;       <span class="comment">/* bitmap blocks pointers */</span>
00039     <span class="keyword">struct </span>bBitmapBlock **bitmapTable;
00040     BOOL *bitmapBlocksChg;
00041 
00042     SECTNUM curDirPtr;
00043 };
00044 
00045 
00046 <span class="keyword">struct </span>Partition {
00047     <span class="keywordtype">long</span> startCyl;
00048     <span class="keywordtype">long</span> lenCyl;
00049     <span class="keywordtype">char</span>* volName;
00050     <span class="keywordtype">int</span> volType;
00051 };
00052 
00053 <span class="comment">/* ----- DEVICES ----- */</span>
00054 
00055 <span class="preprocessor">#define DEVTYPE_FLOPDD      1</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define DEVTYPE_FLOPHD      2</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define DEVTYPE_HARDDISK    3</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#define DEVTYPE_HARDFILE    4</span>
00059 <span class="preprocessor"></span>
00060 <span class="keyword">struct </span>Device {
00061     <span class="keywordtype">int</span> devType;               <span class="comment">/* see below */</span>
00062     BOOL readOnly;
00063     <span class="keywordtype">long</span> size;                 <span class="comment">/* in bytes */</span>
00064 
00065     <span class="keywordtype">int</span> nVol;                  <span class="comment">/* partitions */</span>
00066     <span class="keyword">struct </span>Volume** volList;  
00067     
00068     <span class="keywordtype">long</span> cylinders;            <span class="comment">/* geometry */</span>
00069     <span class="keywordtype">long</span> heads;
00070     <span class="keywordtype">long</span> sectors;
00071 
00072     BOOL isNativeDev;
00073     <span class="keywordtype">void</span> *nativeDev;
00074 };
00075 
00076 
00077 <span class="comment">/* ----- FILE ----- */</span>
00078 
00079 <span class="keyword">struct </span>File {
00080     <span class="keyword">struct </span>Volume *volume;
00081 
00082     <span class="keyword">struct </span>bFileHeaderBlock* fileHdr;
00083     <span class="keywordtype">void</span> *currentData;
00084     <span class="keyword">struct </span>bFileExtBlock* currentExt;
00085 
00086     <span class="keywordtype">long</span> nDataBlock;
00087     SECTNUM curDataPtr;
00088     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pos;
00089 
00090     <span class="keywordtype">int</span> posInDataBlk;
00091     <span class="keywordtype">int</span> posInExtBlk;
00092     BOOL eof, writeMode;
00093     };
00094 
00095 
00096 <span class="comment">/* ----- ENTRY ---- */</span>
00097 
00098 <span class="keyword">struct </span>Entry{
00099     <span class="keywordtype">int</span> type;
00100     <span class="keywordtype">char</span>* name;
00101     SECTNUM sector;
00102     SECTNUM real;
00103     SECTNUM parent;
00104     <span class="keywordtype">char</span>* comment;
00105     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size;
00106     <span class="keywordtype">long</span> access;
00107     <span class="keywordtype">int</span> year, month, days;
00108     <span class="keywordtype">int</span> hour, mins, secs;
00109 };
00110 
00111 <span class="keyword">struct </span>CacheEntry{
00112     <span class="keywordtype">long</span> header, size, protect;
00113     <span class="keywordtype">short</span> days, mins, ticks;
00114     <span class="keywordtype">signed</span> <span class="keywordtype">char</span> type;
00115     <span class="keywordtype">char</span> nLen, cLen;
00116     <span class="keywordtype">char</span> name[MAXNAMELEN+1], comm[MAXCMMTLEN+1];
00117 <span class="comment">/*    char *name, *comm;*/</span>
00118 
00119 };
00120 
00121 
00122 
00123 
00124 <span class="keyword">struct </span>DateTime{
00125     <span class="keywordtype">int</span> year,mon,day,hour,min,sec;
00126 };
00127 
00128 <span class="comment">/* ----- ENVIRONMENT ----- */</span>
00129 
00130 <span class="preprocessor">#define PR_VFCT         1</span>
00131 <span class="preprocessor"></span><span class="preprocessor">#define PR_WFCT         2</span>
00132 <span class="preprocessor"></span><span class="preprocessor">#define PR_EFCT         3</span>
00133 <span class="preprocessor"></span><span class="preprocessor">#define PR_NOTFCT       4</span>
00134 <span class="preprocessor"></span><span class="preprocessor">#define PR_USEDIRC      5</span>
00135 <span class="preprocessor"></span><span class="preprocessor">#define PR_USE_NOTFCT   6</span>
00136 <span class="preprocessor"></span><span class="preprocessor">#define PR_PROGBAR      7</span>
00137 <span class="preprocessor"></span><span class="preprocessor">#define PR_USE_PROGBAR  8</span>
00138 <span class="preprocessor"></span><span class="preprocessor">#define PR_RWACCESS     9</span>
00139 <span class="preprocessor"></span><span class="preprocessor">#define PR_USE_RWACCESS 10</span>
00140 <span class="preprocessor"></span>
00141 <span class="keyword">struct </span>Env{
00142     void (*vFct)(<span class="keywordtype">char</span>*);       <span class="comment">/* verbose callback function */</span>
00143     void (*wFct)(<span class="keywordtype">char</span>*);       <span class="comment">/* warning callback function */</span>
00144     void (*eFct)(<span class="keywordtype">char</span>*);       <span class="comment">/* error callback function */</span>
00145 
00146     void (*notifyFct)(SECTNUM, <span class="keywordtype">int</span>);
00147     BOOL useNotify;
00148 
00149     void (*rwhAccess)(SECTNUM,SECTNUM,BOOL);
00150     BOOL useRWAccess;
00151 
00152     void (*progressBar)(int);
00153     BOOL useProgressBar;
00154 
00155     BOOL useDirCache;
00156     
00157     <span class="keywordtype">void</span> *nativeFct;
00158 };
00159 
00160 
00161 
00162 <span class="keyword">struct </span>List{         <span class="comment">/* generic linked tree */</span>
00163     <span class="keywordtype">void</span> *content;
00164     <span class="keyword">struct </span>List* subdir;
00165     <span class="keyword">struct </span>List* next;
00166 };
00167 
00168 <span class="keyword">struct </span>GenBlock{
00169     SECTNUM sect;
00170     SECTNUM parent;
00171     <span class="keywordtype">int</span> type;
00172     <span class="keywordtype">int</span> secType;
00173     <span class="keywordtype">char</span> *name; <span class="comment">/* if (type == 2 and (secType==2 or secType==-3)) */</span>
00174 };
00175 
00176 <span class="keyword">struct </span>FileBlocks{
00177     SECTNUM header;
00178     <span class="keywordtype">long</span> nbExtens;
00179     SECTNUM* extens;
00180     <span class="keywordtype">long</span> nbData;
00181     SECTNUM* data;
00182 };
00183 
00184 <span class="keyword">struct </span>bEntryBlock {
00185 <span class="comment">/*000*/</span> <span class="keywordtype">long</span>    type;       <span class="comment">/* T_HEADER == 2 */</span>
00186 <span class="comment">/*004*/</span> <span class="keywordtype">long</span>    headerKey;  <span class="comment">/* current block number */</span>
00187         <span class="keywordtype">long</span>    r1[3];
00188 <span class="comment">/*014*/</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   checkSum;
00189 <span class="comment">/*018*/</span> <span class="keywordtype">long</span>    hashTable[HT_SIZE];
00190         <span class="keywordtype">long</span>    r2[2];
00191 <span class="comment">/*140*/</span> <span class="keywordtype">long</span>    access; <span class="comment">/* bit0=del, 1=modif, 2=write, 3=read */</span>
00192 <span class="comment">/*144*/</span> <span class="keywordtype">long</span>    byteSize;
00193 <span class="comment">/*148*/</span> <span class="keywordtype">char</span>    commLen;
00194 <span class="comment">/*149*/</span> <span class="keywordtype">char</span>    comment[MAXCMMTLEN+1];
00195         <span class="keywordtype">char</span>    r3[91-(MAXCMMTLEN+1)];
00196 <span class="comment">/*1a4*/</span> <span class="keywordtype">long</span>    days;
00197 <span class="comment">/*1a8*/</span> <span class="keywordtype">long</span>    mins;
00198 <span class="comment">/*1ac*/</span> <span class="keywordtype">long</span>    ticks;
00199 <span class="comment">/*1b0*/</span> <span class="keywordtype">char</span>    nameLen;
00200 <span class="comment">/*1b1*/</span> <span class="keywordtype">char</span>    name[MAXNAMELEN+1];
00201         <span class="keywordtype">long</span>    r4;
00202 <span class="comment">/*1d4*/</span> <span class="keywordtype">long</span>    realEntry;
00203 <span class="comment">/*1d8*/</span> <span class="keywordtype">long</span>    nextLink;
00204         <span class="keywordtype">long</span>    r5[5];
00205 <span class="comment">/*1f0*/</span> <span class="keywordtype">long</span>    nextSameHash;
00206 <span class="comment">/*1f4*/</span> <span class="keywordtype">long</span>    parent;
00207 <span class="comment">/*1f8*/</span> <span class="keywordtype">long</span>    extension;
00208 <span class="comment">/*1fc*/</span> <span class="keywordtype">long</span>    secType;
00209     };
00210 
00211 
00212 <span class="preprocessor">#define ENV_DECLARATION struct Env adfEnv</span>
00213 <span class="preprocessor"></span>
00214 
00215 <span class="preprocessor">#endif </span><span class="comment">/* _ADF_STR_H */</span>
00216 <span class="comment">/*##########################################################################*/</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:38 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
