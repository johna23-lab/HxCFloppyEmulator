<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ListView.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>ListView.c</h1><a href="_list_view_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* ADF Opus Copyright 1998-2002 by </span>
00002 <span class="comment"> * Dan Sutherland &lt;dan@chromerhino.demon.co.uk&gt; and Gary Harris &lt;gharris@zip.com.au&gt;.   </span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> */</span>
00011 <span class="preprocessor">#include "Pch.h"</span>
00012 
00013 <span class="preprocessor">#include "ListView.h"</span>
00014 
00015 <span class="keywordtype">int</span> LVGetItemFocused(HWND lv)
00016 <span class="comment">/* returns the index of the list-view item that has the focus or -1</span>
00017 <span class="comment"> * if no item has the focus</span>
00018 <span class="comment"> *</span>
00019 <span class="comment"> * hWndLV - handle of the list-view control</span>
00020 <span class="comment"> */</span>
00021 {
00022     <span class="keywordtype">int</span> iNumItems = ListView_GetItemCount(lv);
00023     <span class="keywordtype">int</span> i;
00024 
00025     <span class="keywordflow">for</span> (i = 0 ; i &lt; iNumItems ; i++) {
00026         <span class="keywordflow">if</span> (ListView_GetItemState(lv, i, LVIS_FOCUSED))
00027             <span class="keywordflow">return</span> i;
00028     }
00029 
00030     <span class="keywordflow">return</span> -1;
00031 }
00032 
00033 <span class="keywordtype">void</span> LVSelectAll(HWND lv)
00034 <span class="comment">/* selects all items in a list-view control</span>
00035 <span class="comment"> *</span>
00036 <span class="comment"> * hwndLV - handle of the list-view control</span>
00037 <span class="comment"> */</span>
00038 {
00039     <span class="keywordtype">int</span> iNumItems = ListView_GetItemCount(lv);
00040     <span class="keywordtype">int</span> i;
00041 
00042     <span class="keywordflow">for</span> (i = 0 ; i &lt; iNumItems ; i++)
00043         ListView_SetItemState(lv, i, LVIS_SELECTED, LVIS_SELECTED);
00044 }
00045 
00046 <span class="keywordtype">void</span> LVSelectNone(HWND lv)
00047 <span class="comment">/* deselects all items in a list-view control</span>
00048 <span class="comment"> *</span>
00049 <span class="comment"> * lv - handle of the list-view control</span>
00050 <span class="comment"> */</span>
00051 {
00052     <span class="keywordtype">int</span> count = ListView_GetItemCount(lv);
00053     <span class="keywordtype">int</span> i;
00054 
00055     <span class="keywordflow">for</span> (i = 0 ; i &lt; count ; i++)
00056         ListView_SetItemState(lv, i, 0, LVIS_SELECTED);
00057 }
00058 
00059 <span class="keywordtype">void</span> LVInvert(HWND lv)
00060 <span class="comment">/* toggles selected items in a list-view control</span>
00061 <span class="comment"> *</span>
00062 <span class="comment"> * lv - handle of the list-view control</span>
00063 <span class="comment"> */</span>
00064 {
00065     <span class="keywordtype">int</span> count = ListView_GetItemCount(lv);
00066     <span class="keywordtype">int</span> i;
00067     UINT newState;
00068 
00069     <span class="keywordflow">for</span> (i = 0 ; i &lt; count ; i++) {
00070         newState = ListView_GetItemState(lv, i, LVIS_SELECTED) == LVIS_SELECTED;
00071         ListView_SetItemState(lv, i, newState ? 0 : LVIS_SELECTED, LVIS_SELECTED);
00072     }
00073 }
00074 
00075 BOOL LVAddColumn(HWND lv, <span class="keywordtype">char</span> *title, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> pos)
00076 <span class="comment">/* adds a column to a list-view control</span>
00077 <span class="comment"> *</span>
00078 <span class="comment"> * hwndLV - handle of the list-view control</span>
00079 <span class="comment"> * pstrTitle - heading for the new column</span>
00080 <span class="comment"> * iWidth - width of the new column (in pixels)</span>
00081 <span class="comment"> * iPos - position (index) to add column in</span>
00082 <span class="comment"> *</span>
00083 <span class="comment"> * returns: TRUE if the column was added OK, FALSE otherwise</span>
00084 <span class="comment"> */</span>
00085 {
00086     LV_COLUMN lvc;
00087  
00088     <span class="comment">/* Initialize the LV_COLUMN structure. */</span>
00089     lvc.mask = LVCF_FMT | LVCF_WIDTH | LVCF_TEXT | LVCF_SUBITEM;
00090     lvc.fmt = LVCFMT_LEFT;
00091     lvc.pszText = title;
00092 
00093     <span class="comment">/* Add the column */</span>
00094     lvc.iSubItem = 0; 
00095     lvc.cx = width;
00096 
00097     <span class="keywordflow">return</span> (ListView_InsertColumn(lv, pos, &amp;lvc) != -1);
00098 }
00099 
00100 BOOL LVGetItemCaption(HWND lv, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> bufSize, <span class="keywordtype">int</span> index)
00101 <span class="comment">/* returns the caption of the specified item in a list-view control</span>
00102 <span class="comment"> *</span>
00103 <span class="comment"> * hwndLV - handle of the list-view control</span>
00104 <span class="comment"> * szStrBuf - buffer to store the caption string</span>
00105 <span class="comment"> * iBufSize - size of the string buffer</span>
00106 <span class="comment"> * iIndex - index of the item to get</span>
00107 <span class="comment"> *</span>
00108 <span class="comment"> * returns: TRUE if the operation succeeded, FALSE otherwise</span>
00109 <span class="comment"> */</span>
00110 {
00111     LV_ITEM lvi;
00112 
00113     lvi.mask = LVIF_TEXT;
00114     lvi.iItem = index;
00115     lvi.iSubItem = 0;
00116     lvi.pszText = buf;
00117     lvi.cchTextMax = bufSize;
00118 
00119     <span class="keywordflow">return</span> ListView_GetItem(lv, &amp;lvi);
00120 }
00121 
00122 <span class="keywordtype">int</span> LVGetItemImageIndex(HWND lv, <span class="keywordtype">int</span> index)
00123 <span class="comment">/* returns the image index of the specified item in the specified list-view</span>
00124 <span class="comment"> *</span>
00125 <span class="comment"> * hwndLV - handle of the list-view control</span>
00126 <span class="comment"> * iIndex - index of the item to get</span>
00127 <span class="comment"> *</span>
00128 <span class="comment"> * returns: the image index or -1 on error</span>
00129 <span class="comment"> */</span>
00130 {
00131     LV_ITEM lvi;
00132 
00133     lvi.mask = LVIF_IMAGE;
00134     lvi.iItem = index;
00135     lvi.iSubItem = 0;
00136     lvi.pszText = NULL;
00137     lvi.cchTextMax = 0;
00138     <span class="keywordflow">if</span> (! ListView_GetItem(lv, &amp;lvi))
00139         <span class="keywordflow">return</span> -1;
00140 
00141     <span class="keywordflow">return</span> lvi.iImage;
00142 }
00143 
00144 BOOL LVGetItemText(HWND lv, <span class="keywordtype">int</span> index, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> bufSize)
00145 <span class="comment">/* gets the text of a specified list-view item and puts it in the provided buffer</span>
00146 <span class="comment"> *</span>
00147 <span class="comment"> * hwndLV - handle of the list-view control</span>
00148 <span class="comment"> * iIndex - index of the item</span>
00149 <span class="comment"> * strBuf - pointer to a buffer that will receive the text</span>
00150 <span class="comment"> * iBS    - size of strBuf</span>
00151 <span class="comment"> *</span>
00152 <span class="comment"> * returns TRUE on success, otherwise FALSE (could happen if strBuf is too small)</span>
00153 <span class="comment"> */</span>
00154 {
00155     LV_ITEM item;
00156 
00157     item.mask = LVIF_TEXT;
00158     item.iItem = index;
00159     item.iSubItem = 0;
00160     item.pszText = buf;
00161     item.cchTextMax = bufSize;
00162 
00163     <span class="keywordflow">return</span> ListView_GetItem(lv, &amp;item);
00164 }
00165 
00166 BOOL LVIsItemSelected(HWND lv, <span class="keywordtype">int</span> index)
00167 {
00168     <span class="keywordflow">return</span> ListView_GetItemState(lv, index, LVIS_SELECTED) == LVIS_SELECTED;
00169 }
00170 
00171 <span class="keywordtype">int</span> LVAddItem(HWND lv, <span class="keywordtype">char</span> *caption, <span class="keywordtype">int</span> image)
00172 {
00173     LV_ITEM lvi;
00174 
00175     lvi.mask = LVIF_TEXT | LVIF_IMAGE | LVIF_PARAM | LVIF_STATE;
00176     lvi.state = 0;
00177     lvi.stateMask = 0;
00178     lvi.pszText = caption;
00179     lvi.iItem = ListView_GetItemCount(lv);
00180     lvi.iSubItem = 0;
00181     lvi.iImage = image;
00182 
00183     <span class="keywordflow">if</span> (ListView_InsertItem(lv, &amp;lvi))
00184         <span class="keywordflow">return</span> lvi.iItem;
00185     <span class="keywordflow">else</span>
00186         <span class="keywordflow">return</span> -1;
00187 }
00188 
00189 BOOL LVAddSubItem(HWND lv, <span class="keywordtype">char</span> *caption, <span class="keywordtype">int</span> item, <span class="keywordtype">int</span> subitem)
00190 {
00191     LV_ITEM lvi;
00192 
00193     lvi.mask = LVIF_TEXT;
00194     lvi.state = 0;
00195     lvi.stateMask = 0;
00196     lvi.pszText = caption;
00197     lvi.iItem = item;
00198     lvi.iSubItem = subitem;
00199     lvi.iImage = 0;
00200 
00201     <span class="keywordflow">return</span> ListView_SetItem(lv, &amp;lvi);
00202 }
</pre></div><hr><address style="align: right;"><small>Generated on Tue Nov 5 12:21:42 2002 for dynlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
